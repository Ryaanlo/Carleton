;Ryan Lo (101117765)

; Cube Function
; Input : int
; Output : Cubes the input, returns int
(define (cube x) (* x x x))
(cube 3)

; Compute Functions
; Computes f(x) = 3x^2 + 1
(define (f x) (+ (* 3 (* x x)) 1))
(f 2)

; Computes g(x) = f(2x) - 2x^3
(define (g x) (- (f (* 2 x)) (* 2 (* x x x))))
(g 2)

; Computes h(x) = 3f(x/2) = g(x)
(define (h x) (+ (* 3 (f (/ x 2))) (g x)))
(h 2)


(newline)
; e) Normal Order Evaluation
(h (* 2 3))
(h 6)
(+ (* 3 (f (/ 6 2))) (g 6))
(+ (* 3 (f 3)) (g 6))
(+ (* 3 (+ (* 3 (* 3 3)) 1)) (- (f (* 2 6)) (* 2 (* 6 6 6))))
(+ (* 3 (+ (* 3 9) 1)) (- (f 12) (* 2 216)))
(+ (* 3 (+ 27 1)) (- (+ (* 3 (* 12 12)) 1) 432))
(+ (* 3 28) (- (+ (* 3 144) 1) 432))
(+ 84 (- (+ 432 1) 432))
(+ 84 1)
85


(newline)
; f) Applicative Order Evaluation
(h (* 2 3))
(+ (* 3 (f (/ (* 2 3) 2))) (g (* 2 3)))
(+ (* 3 (+ (* 3 (* (/ (* 2 3) 2)) (/ (* 2 3) 2)) 1)) (g (* 2 3)))
(+ (* 3 (+ (* 3 (* (/ (* 2 3) 2)) (/ (* 2 3) 2)) 1)) (- (+ (* 3 (* (* 2 (* 2 3)) (* 2 (* 2 3)))) 1) (* 2 (* (* 2 3) (* 2 3) (* 2 3)))))
(+ (* 3 (+ (* 3 (* (/ 6 2) (/ 6 2))) 1)) (- (+ (* 3 (* (* 2 6) (* 2 6))) 1) (* 2 (* 6 6 6))))
(+ (* 3 (+ (* 3 (* 3 3)) 1)) (- (+ (* 3 (* 12 12)) 1) (* 2 216)))
(+ (* 3 (+ (* 3 9) 1)) (- (+ (* 3 144) 1) 432))
(+ (* 3 (+ 27 1)) (- (+ 432 1) 432))
(+ (* 3 (+ 27 1)) (- 433 432))
(+ (* 3 28) 1)
(+ 84 1)
85
