let test = {
	"Test 1" : [{"category":"Entertainment: Television","type":"multiple","difficulty":"medium","question":"In what year did &quot;The Big Bang Theory&quot; debut on CBS?","correct_answer":"2007","incorrect_answers":["2008","2006","2009"]},{"category":"Geography","type":"multiple","difficulty":"medium","question":"Which city is the capital of Switzerland?","correct_answer":"Bern","incorrect_answers":["Z&uuml;rich","Frankfurt","Wien"]},{"category":"Animals","type":"multiple","difficulty":"hard","question":"How many known living species of hyenas are there?","correct_answer":"4","incorrect_answers":["8","2","6"]},{"category":"History","type":"multiple","difficulty":"hard","question":"The Battle of Hastings was fought in which year?","correct_answer":"1066","incorrect_answers":["911","1204","1420"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"hard","question":"&quot;All the Boys&quot; by Panic! At the Disco was released as a bonus track on what album?","correct_answer":"Too Weird To Live, Too Rare To Die!","incorrect_answers":["A Fever You Can&#039;t Sweat Out","Death Of A Bachelor","Vices &amp; Virtues"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"easy","question":"What was Daft Punk&#039;s first studio album?","correct_answer":"Homework","incorrect_answers":["Discovery","Random Access Memories","Human After All"]},{"category":"Science & Nature","type":"multiple","difficulty":"hard","question":"How much radiation does a banana emit?","correct_answer":"0.1 Microsievert","incorrect_answers":["0.3 Microsievert","0.5 Microsievert","0.7 Microsievert"]},{"category":"Sports","type":"multiple","difficulty":"hard","question":"What is the full name of the footballer &quot;Cristiano Ronaldo&quot;?","correct_answer":"Cristiano Ronaldo dos Santos Aveiro","incorrect_answers":["Cristiano Ronaldo los Santos Diego","Cristiano Armando Diego Ronaldo","Cristiano Luis Armando Ronaldo"]},{"category":"Animals","type":"multiple","difficulty":"medium","question":"The dish Fugu, is made from what family of fish?","correct_answer":"Pufferfish","incorrect_answers":["Bass","Salmon","Mackerel"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"What are the names of the Ice Climbers in the video game Ice Climber?","correct_answer":"Popo and Nana","incorrect_answers":["Popo and Nina","Papi and Nana","Papi and Nina"]}],
	
	"Test 2" : [{"category":"Vehicles","type":"multiple","difficulty":"hard","question":"What was the name of the first front-wheel-drive car produced by Datsun (now Nissan)?","correct_answer":"Cherry","incorrect_answers":["Sunny","Bluebird","Skyline"]},{"category":"History","type":"multiple","difficulty":"medium","question":"America&#039;s Strategic Defense System during the Cold War was nicknamed after this famous movie.","correct_answer":"Star Wars","incorrect_answers":["Jaws","Blade Runner","Alien"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"In Portal 2, the iconic character GLaDOS is turned into:","correct_answer":"A potato","incorrect_answers":["A tomato","A lemon","An apple"]},{"category":"History","type":"multiple","difficulty":"hard","question":"When did Canada leave the confederation to become their own nation?","correct_answer":"July 1st, 1867","incorrect_answers":["July 1st, 1763","July 1st, 1832","July 1st, 1902"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"easy","question":"The &quot;K&quot; in &quot;K-Pop&quot; stands for which word?","correct_answer":"Korean","incorrect_answers":["Kenyan","Kazakhstan","Kuwaiti"]},{"category":"History","type":"boolean","difficulty":"medium","question":"United States President Ronald Reagan was the first president to appoint a woman to the Supreme Court. ","correct_answer":"True","incorrect_answers":["False"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"easy","question":"What is the name of the 4-armed Chaos Witch from the 2016 video game &quot;Battleborn&quot;?","correct_answer":"Orendi","incorrect_answers":["Orendoo","Oranda","Randy"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"medium","question":"Ellie Goulding&#039;s earliest album was named?","correct_answer":"Lights","incorrect_answers":["Halcyon","Bright Lights","Halcyon Days"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"easy","question":"Which former boy-band star released hit solo single &quot;Angels&quot; in 1997?","correct_answer":"Robbie Williams","incorrect_answers":["Justin Timberlake","Harry Styles","Gary Barlow"]},{"category":"Entertainment: Japanese Anime & Manga","type":"multiple","difficulty":"medium","question":"In &quot;Puella Magi Madoka Magica&quot;, what is the first name of Madoka&#039;s younger brother?","correct_answer":"Tatsuya","incorrect_answers":["Montoya","Tomohisa","Minato"]}],
	
	"Test 3" : [{"category":"Entertainment: Video Games","type":"multiple","difficulty":"easy","question":"Which game did &quot;Sonic The Hedgehog&quot; make his first appearance in?","correct_answer":"Rad Mobile","incorrect_answers":["Sonic The Hedgehog","Super Mario 64","Mega Man"]},{"category":"Politics","type":"multiple","difficulty":"medium","question":"Who was the only president to not be in office in Washington D.C?","correct_answer":"George Washington","incorrect_answers":["Abraham Lincoln","Richard Nixon","Thomas Jefferson"]},{"category":"Entertainment: Books","type":"multiple","difficulty":"hard","question":"In the Harry Potter universe, who does Draco Malfoy end up marrying?","correct_answer":"Astoria Greengrass","incorrect_answers":["Pansy Parkinson","Millicent Bulstrode","Hermione Granger"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"In what year was the original Sonic the Hedgehog game released?","correct_answer":"1991","incorrect_answers":["1989","1993","1995"]},{"category":"General Knowledge","type":"multiple","difficulty":"medium","question":"What is the name given to Indian food cooked over charcoal in a clay oven?","correct_answer":"Tandoori","incorrect_answers":["Biryani","Pani puri","Tiki masala"]},{"category":"Vehicles","type":"multiple","difficulty":"easy","question":"Automobiles produced by Telsa Motors operate on which form of energy?","correct_answer":"Electricity","incorrect_answers":["Gasoline","Diesel","Nuclear"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"easy","question":"Who was featured in the song &quot;Words&quot; by Feint? ","correct_answer":"Laura Brehm","incorrect_answers":["Anna Yvette ","Danyka Nadeau","Veela"]},{"category":"Entertainment: Film","type":"multiple","difficulty":"medium","question":"Leonardo Di Caprio won his first Best Actor Oscar for his performance in which film?","correct_answer":"The Revenant","incorrect_answers":["The Wolf Of Wall Street","Shutter Island","Inception"]},{"category":"Sports","type":"multiple","difficulty":"medium","question":"What year was hockey legend Wayne Gretzky born?","correct_answer":"1961","incorrect_answers":["1965","1959","1963"]},{"category":"Entertainment: Film","type":"multiple","difficulty":"hard","question":"Which sci-fi cult films plot concerns aliens attempting to prevent humans from creating a doomsday weapon?","correct_answer":"Plan 9 from Outer Space","incorrect_answers":["The Man from Planet X","It Came from Outer Space","The Day The Earth Stood Still"]}],
	
	"Test 4" : [{"category":"Entertainment: Cartoon & Animations","type":"boolean","difficulty":"easy","question":"In the &quot;Shrek&quot; film franchise, Donkey is played by Eddie Murphy.","correct_answer":"True","incorrect_answers":["False"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"What was the character Kirby originally going to be named?","correct_answer":"Popopo","incorrect_answers":["Dedede","Waddle Dee","Prince Puff"]},{"category":"Geography","type":"multiple","difficulty":"medium","question":"Which country inside the United Kingdom does NOT appear on its flag, the Union Jack?","correct_answer":"Wales","incorrect_answers":["Scotland","Ireland","Isle of Wight"]},{"category":"Mythology","type":"multiple","difficulty":"easy","question":"Who in Greek mythology, who led the Argonauts in search of the Golden Fleece?","correct_answer":"Jason","incorrect_answers":["Castor","Daedalus","Odysseus"]},{"category":"Animals","type":"multiple","difficulty":"medium","question":"Cashmere is the wool from which kind of animal?","correct_answer":"Goat","incorrect_answers":["Sheep","Camel","Llama"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"hard","question":"In Halo 2, how many rounds does the M6C hold in a single magazine?","correct_answer":"12","incorrect_answers":["6","36","18"]},{"category":"Entertainment: Film","type":"multiple","difficulty":"medium","question":"Who played the Cenobite called &quot;Pinhead&quot; in the original Hellraiser films?","correct_answer":"Doug Bradley","incorrect_answers":["Doug Jones","Doug Savant","Doug Benson"]},{"category":"Entertainment: Comics","type":"multiple","difficulty":"medium","question":"In the comics, which Sonic character took command of the Dark Legion after Luger&#039;s assassination?","correct_answer":"Lien-Da","incorrect_answers":["Kragok","Dimitri","Remington"]},{"category":"Entertainment: Japanese Anime & Manga","type":"multiple","difficulty":"medium","question":"In Haikyuu!!, who is not a member of Karasuno VBC?","correct_answer":"Shigeru Yahaba","incorrect_answers":["Tadashi Yamaguchi","Hisashi Kinoshita","Kazuhito Narita"]},{"category":"Entertainment: Musicals & Theatres","type":"multiple","difficulty":"medium","question":"The musical &quot;Dirty Rotten Scoundrels&quot; is set in what country?","correct_answer":"France","incorrect_answers":["USA","Germany","Sweden"]}],
	
	"Test 5" : [{"category":"Entertainment: Television","type":"multiple","difficulty":"easy","question":"What was the name of the police officer in the cartoon &quot;Top Cat&quot;?","correct_answer":"Dibble","incorrect_answers":["Barbrady","Mahoney","Murphy"]},{"category":"Animals","type":"multiple","difficulty":"easy","question":"The K\u0101k\u0101p\u014d is a large, flightless, nocturnal parrot native to which country?","correct_answer":"New Zealand","incorrect_answers":["South Africa","Australia","Madagascar"]},{"category":"Entertainment: Musicals & Theatres","type":"multiple","difficulty":"medium","question":"In which Shakespeare play does the character Marcellus say, &quot;Something is rotten in the state of Denmark&quot;?","correct_answer":"Hamlet","incorrect_answers":["Macbeth","King Lear","Twelfth Night"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"hard","question":"Which M83 album is the song &quot;Midnight City&quot; featured in?","correct_answer":"Hurry Up, We&#039;re Dreaming","incorrect_answers":["Saturdays = Youth","Before the Dawn Heals Us","Junk"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"easy","question":"Which of these songs by Skrillex features Fatman Scoop as a side artist?","correct_answer":"Recess","incorrect_answers":["All is Fair in Love and Brostep","Rock N Roll (Will Take You to the Mountain)","Scary Monsters and Nice Sprites"]},{"category":"Science: Computers","type":"multiple","difficulty":"medium","question":"Generally, which component of a computer draws the most power?","correct_answer":"Video Card","incorrect_answers":["Hard Drive","Processor","Power Supply"]},{"category":"Vehicles","type":"multiple","difficulty":"medium","question":"Which supercar company is from Sweden?","correct_answer":"Koenigsegg","incorrect_answers":["Bugatti","Lamborghini","McLaren"]},{"category":"Geography","type":"multiple","difficulty":"hard","question":"What is the area of Vatican City?","correct_answer":"0.44km^2","incorrect_answers":["0.10km^2","0.86km^2","12.00km^2"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"Final Fantasy VI was originally released outside Japan under what name?","correct_answer":"Final Fantasy III","incorrect_answers":["Final Fantasy VI","Final Fantasy V","Final Fantasy II"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"easy","question":"Who turns out to be the true victor in the Battle of Armageddon in Mortal Kombat?","correct_answer":"Shao Kahn","incorrect_answers":["Liu Kang","Shang Tsung","Raiden"]}],
	
	"Test 6" : [{"category":"Animals","type":"multiple","difficulty":"medium","question":"What color\/colour is a polar bear&#039;s skin?","correct_answer":"Black","incorrect_answers":["White","Pink","Green"]},{"category":"Celebrities","type":"multiple","difficulty":"easy","question":"By what name is Carlos Estevez better known? ","correct_answer":"Charlie Sheen","incorrect_answers":["Ricky Martin","Bruno Mars","Joaquin Phoenix"]},{"category":"Entertainment: Books","type":"multiple","difficulty":"medium","question":"What was the pen name of novelist, Mary Ann Evans?","correct_answer":"George Eliot","incorrect_answers":["George Orwell","George Bernard Shaw","George Saunders"]},{"category":"Entertainment: Music","type":"multiple","difficulty":"medium","question":"EDM producer Marshmello performs live wearing clothes and a marshmallow mask of what colour?","correct_answer":"White","incorrect_answers":["Black","Blue","Yellow"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"In Left 4 Dead, what is the name of the Special Infected that is unplayable in Versus mode?","correct_answer":"The Witch","incorrect_answers":["The Tank","The Smoker","The Spitter"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"What is the full name of the protagonist from the SNES game Clock Tower?","correct_answer":"Jennifer Simpson","incorrect_answers":["Jennifer Barrows","Jennifer Cartwright","Jennifer Maxwell"]},{"category":"Science: Computers","type":"multiple","difficulty":"hard","question":"Which of the following is the oldest of these computers by release date?","correct_answer":"TRS-80","incorrect_answers":["Commodore 64","ZX Spectrum","Apple 3"]},{"category":"Entertainment: Video Games","type":"multiple","difficulty":"medium","question":"When was &quot;System Shock&quot; released?","correct_answer":"1994","incorrect_answers":["1995","2000","1998"]},{"category":"Science: Computers","type":"multiple","difficulty":"hard","question":"What vulnerability ranked #1 on the OWASP Top 10 in 2013?","correct_answer":"Injection ","incorrect_answers":["Broken Authentication","Cross-Site Scripting","Insecure Direct Object References"]},{"category":"Mythology","type":"multiple","difficulty":"easy","question":"What mythological creatures have women&#039;s faces and vultures&#039; bodies?","correct_answer":"Harpies","incorrect_answers":["Mermaids","Nymph","Lilith"]}]
}

/* Array for storing all the correct answers in a set of questions */
let correctAnswer = [];

/* Function that is initialized when body is loaded           */
/* Gives the loadTest and randomTest buttons an onclick event */
function init(){
	let loadTest = document.getElementById("load");
	loadTest.onclick = loadTestClicked;

	let randomTest = document.getElementById("random");
	randomTest.onclick = loadRandomClicked;
}

/* Function for when the loadTest button is clicked */
function loadTestClicked(){
	/* Get the list of tests and select button */
	let list = document.getElementById("test");
	let select = document.getElementById("select");

	/* Clear everything in the list */
	while(list.firstChild){
		list.removeChild(list.firstChild);
	}

	/* Function to create and load the test */
	createTest(test, select.value);
}

/* Function for when loadRandom button is clicked */
function loadRandomClicked(){
	/* Get the list of tests */
	let list = document.getElementById("test");
	/* Get the length from the number of questions input */
	let numOfQuestions = document.getElementById("text").value.length;

	/* If input is empty, set default to 10, else get inputted the number */
	if (numOfQuestions === 0){
		numOfQuestions = 10;
	}else{
		numOfQuestions = document.getElementById("text").value;
	}

	/* Get XML request */
	let xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		/* If everything is working */
		if (this.readyState == 4 && this.status == 200){
			/* Get the response and parse it */
			let jsonResponse = JSON.parse(this.response);

			/* Clear everything in the list */
			while(list.firstChild){
				list.removeChild(list.firstChild);
			}

			/* Create the test from the response */
			createTest(jsonResponse.results, 0);
		}
	};
	/* Get the test with the user inputted number of questions */
	xhttp.open("GET", "https://opentdb.com/api.php?amount=" + numOfQuestions, true);
	xhttp.send();
}

/* Function for creating the test and appending it to the list */
function createTest(tests, selected){
	/* Get the list */
	let list = document.getElementById("test");
	/* Empty out/Clear everything in the correctAnswer array */
	correctAnswer = [];

	/* Since the XML response is different from the test object in this file, */
	/* We need to match it, so since the response is all ready an array */
	/* We need to change the tests to index into a test array */
	/* If it isn't an array we index into the test array of whatever is selected */
	if (!Array.isArray(tests)){
		tests = tests[selected];
	}

	/* Loop over the number of questions in the array */
	for (let i = 0; i < tests.length; i ++){
		/* Array to store possible selections */
		let options = [];
		/* Array to store randomized possible selections */
		let randOptions = [];
		/* Add the first option */
		options.push(tests[i]["correct_answer"]);
		/* Add the correct answers to the Array */
		correctAnswer.push(tests[i]["correct_answer"]);
		/* Add the rest of the possible options */
		for (let j = 0; j < (tests[i]["incorrect_answers"].length); j ++){
			options.push(tests[i]["incorrect_answers"][j]);
		}

		/* Variable for amount of questions */
		let questionAmount = options.length;
		let rand = options.length;

		/* Randomize choices */
		for (let j = 0; j < questionAmount; j ++){
			let randNum = Math.floor(Math.random() * Math.floor(rand));
			randOptions.push(options[randNum]);
			options.splice(randNum, 1);
			rand --;
		}


		/* Question Text */
		let text = document.createTextNode(tests[i]["question"]);
		let questionText = document.createElement("strong"); 
		questionText.setAttribute("name", "questionText");
		questionText.appendChild(text);

		/* Create a form to store all radio input of a question */
		let form = document.createElement("form");

		/* Loop over the number of options in a question */
		for (let j = 0; j < randOptions.length; j ++){
			/* Create radio input and label for the option text */
			let radio = document.createElement("input");
			let optionText = document.createElement("label");

			/* Set attributes for radio input */
			radio.setAttribute("type", "radio");
			radio.setAttribute("name", "option");
			radio.setAttribute("value", randOptions[j]);

			/* Set the optionText */
			optionText.innerHTML = randOptions[j];

			/* Create div to store a selection */
			let selection = document.createElement("div");
			selection.appendChild(radio);
			selection.appendChild(optionText);
			selection.appendChild(createBr());

			/* Store all the radio buttons for each question into the form */
			/* Set name of form */
			form.appendChild(selection);
			form.setAttribute("name", "form");
		}

		/* Create  a div to store every element of a question */
		let group = document.createElement("div");
		group.setAttribute("name", "group");
		group.appendChild(questionText);
		group.appendChild(form);
		group.appendChild(createBr());

		/* Append the whole question to the list of question */
		list.appendChild(group);
	}

	// Create Clear and Check Answer Buttons
	let clear = document.createElement("button");
	let check = document.createElement("button");
	clear.setAttribute("type", "button");
	check.setAttribute("type", "button");
	clear.innerHTML = "Clear Test";
	check.innerHTML = "Check Test";

	/* Set the onclick to activate a function */
	clear.onclick = clearOptions;
	check.onclick = checkAnswer;

	/* Append those buttons to the list */
	list.appendChild(clear);
	list.appendChild(check);
}

/* Function for clearing all options and everything created by check answer */
function clearOptions(){
	/* Get the radio buttons, images, questionText, scoreText */
	let options = document.getElementsByName("option");
	let image = document.getElementsByName("image");
	let questionText = document.getElementsByName("questionText");
	let scoreText = document.getElementsByName("score");
	/* Create a confirmation for clearing */
	let clear = confirm("Do you want to clear all current test answers?");

	/* If confirmed yes */
	if (clear){
		/* Clear all selections */
		for (let i = 0; i < options.length; i ++){
			options[i].checked = false;
		}
		/* Reset all questionText colours */
		for (let i = 0; i < questionText.length; i ++){
			questionText[i].style.color = 'black';
		}
		/* Remove all images */
		while (image.length > 0){
			image[0].remove();
		}
		/* Remove scoreText */
		for (let i = 0; i < scoreText.length; i ++){
			scoreText[i].remove();
		}	
	}
}

/* Function for checking answers */
function checkAnswer(){
	// Remove any previous Score & Images
	let scoreText = document.getElementsByName("score");
	for (let i = 0; i < scoreText.length; i ++){
		scoreText[i].remove();
	}	

	/* Remove any previous images */
	let image = document.getElementsByName("image");
	while (image.length > 0){
		image[0].remove();
	}	
	
	/* Variable for score */
	let score = 0;
	/* Boolean for checking if at least one selection is selected */
	let checked = false;
	/* Array to store if at least one selection is made for each question */
	let answered = [];
	/* Boolean for if at least one is unchecked */
	let unanswered = false;
	/* Get all radio buttons in a question, get the list, get the questionText, get all question */
	let form = document.getElementsByName("form");
	let list = document.getElementById("test");
	let question = document.getElementsByName("questionText");
	let group = document.getElementsByName("group");
	/* Boolean for if selected option was correct */
	let correct = false;
	
	/* Loop over all questions */
	for (let i = 0; i < form.length; i ++){
		/* Reset boolean */
		checked = false;
		for (let j = 0; j < form[i].length; j ++){
			/* If at least one is checked */
			if (form[i][j].checked) {
				checked = true;
				break;
			}
		}
		
		/* Add to the array if a selection is selected or not */
		if (checked){
			answered.push(true);
		}else{
			answered.push(false);
		}
	}

	// Reset any red colours
	for (let i = 0; i < question.length; i ++){
		question[i].style.color = 'black';
	}

	/* For any unanswered questions, set the colour of question to red */
	for (let i = 0; i < answered.length; i ++){
		if (answered[i] === false){
			question[i].style.color = 'red';
			unanswered = true;
		}
	}

	/* If at least one question unanswered */
	if (unanswered){
		alert("You have not answered some questions!");
	/* If all question is answered */
	}else{
		/* Loop over every question */
		for (let i = 0; i < group.length; i ++){
			/* Loop over every selection */
			for (let j = 0; j < form[i].length; j ++){
				/* If that selection is checked */
				if (form[i][j].checked) {
					/* Reset boolean */
					correct = false;
					/* Loop over all correct answers */
					for (let k = 0; k < correctAnswer.length; k ++){
						/* If the selected answer match one of the correct answers */
						if (form[i][j].value == correctAnswer[k]){
							/* Add score, insert the check image and set boolean to correct */
							score ++;
							form[i].children[j].insertBefore(createCheckImage(), form[i].children[j].childNodes[2]);
							correct = true;
							break;
						}
					}
					/* If it was incorrect */
					if (!correct){
						/* Give them an X image1 */
						form[i].children[j].insertBefore(createXImage(), form[i].children[j].childNodes[2]);
					}
				}
			}
		}
	}
	
	/* Create the total score text and append to list */
	let totalScore = document.createTextNode(" Your score is " + score + "/" + form.length);
	let finalScore = document.createElement("div");
	finalScore.appendChild(totalScore);
	finalScore.setAttribute("name", "score");
	list.appendChild(finalScore);
}

/* Function that returns a picture of the Check Image */
function createCheckImage(){
	let checkImg = document.createElement("img");
	checkImg.setAttribute("name", "image");
	checkImg.src = "check.png";
	return checkImg;
}

/* Function that returns a picture of the X Image */
function createXImage(){
	let xImg = document.createElement("img");
	xImg.setAttribute("name", "image");
	xImg.src = "x.png";
	return xImg;
}

/* Function that returns a br */
function createBr(){
	let br = document.createElement("br");
	return br;
}